<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ad Blocker Testing Suite | Professional Web Development</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --accent-color: #3b82f6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-bg: #0f172a;
            --card-bg: #1e293b;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --border-color: #334155;
            --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--dark-bg) 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: var(--card-bg);
            padding: 30px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color), var(--success-color));
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .controls-panel {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .control-group {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .control-group h3 {
            color: var(--accent-color);
            margin-bottom: 15px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
            margin-left: 10px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #64748b;
            transition: 0.3s;
            border-radius: 30px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--success-color);
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        .rule-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .rule-item:last-child {
            border-bottom: none;
        }

        .rule-item label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .blocked { color: var(--danger-color); }
        .allowed { color: var(--success-color); }
        .total { color: var(--accent-color); }

        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        .test-site {
            background: white;
            color: #333;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            min-height: 600px;
        }

        .site-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .site-content {
            padding: 30px;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
        }

        .main-article {
            line-height: 1.6;
        }

        .main-article h2 {
            margin-bottom: 15px;
            color: #2d3748;
        }

        .main-article p {
            margin-bottom: 15px;
            color: #4a5568;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* Ad Elements */
        .ad-banner {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            padding: 20px;
            text-align: center;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .ad-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s;
        }

        .ad-banner:hover::before {
            left: 100%;
        }

        .ad-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 1000;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            max-width: 300px;
            animation: slideIn 0.3s ease;
        }

        .ad-sidebar {
            background: linear-gradient(135deg, #11998e, #38ef7d);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .ad-native {
            background: #f7fafc;
            border: 2px dashed #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            color: #718096;
            font-style: italic;
        }

        .ad-video {
            background: #000;
            color: white;
            padding: 30px;
            text-align: center;
            border-radius: 8px;
            position: relative;
        }

        .ad-interstitial {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .interstitial-content {
            background: linear-gradient(135deg, #667eea, #764ba2);
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            color: white;
            max-width: 400px;
        }

        .close-btn {
            background: var(--danger-color);
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            transition: background-color 0.3s;
        }

        .close-btn:hover {
            background: #dc2626;
        }

        /* Blocked states */
        .blocked-element {
            display: none !important;
        }

        .blocked-placeholder {
            background: repeating-linear-gradient(
                45deg,
                #fee2e2,
                #fee2e2 10px,
                #fecaca 10px,
                #fecaca 20px
            );
            color: var(--danger-color);
            padding: 15px;
            text-align: center;
            border: 2px dashed var(--danger-color);
            border-radius: 8px;
            font-weight: bold;
        }

        .performance-monitor {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            border: 1px solid var(--border-color);
        }

        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .performance-item {
            text-align: center;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        .performance-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-color);
        }

        .performance-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .site-content {
                grid-template-columns: 1fr;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
        }

        .export-btn {
            background: linear-gradient(135deg, var(--success-color), #059669);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
        }

        .test-results {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
            border: 1px solid var(--border-color);
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            margin: 5px 0;
            border-radius: 8px;
            background: rgba(255,255,255,0.05);
        }

        .status-indicator {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-blocked {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger-color);
        }

        .status-allowed {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🛡️ Ad Blocker Testing Suite</h1>
            <p>Professional-grade testing environment for ad blocking rules and patterns. Test, visualize, and analyze ad blocking behavior in real-time.</p>
        </div>

        <div class="stats-panel">
            <div class="stat-card">
                <div class="stat-value blocked" id="blockedCount">0</div>
                <div class="stat-label">Elements Blocked</div>
            </div>
            <div class="stat-card">
                <div class="stat-value allowed" id="allowedCount">0</div>
                <div class="stat-label">Elements Allowed</div>
            </div>
            <div class="stat-card">
                <div class="stat-value total" id="totalCount">0</div>
                <div class="stat-label">Total Elements</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="efficiencyRate">0%</div>
                <div class="stat-label">Block Efficiency</div>
            </div>
        </div>

        <div class="controls-panel">
            <div class="controls-grid">
                <div class="control-group">
                    <h3>🎯 Ad Pattern Blocking</h3>
                    <div class="rule-item">
                        <label for="blockBanners">Banner Advertisements</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="blockBanners" checked>
                            <span class="slider"></span>
                        </div>
                    </div>
                    <div class="rule-item">
                        <label for="blockPopups">Popup Advertisements</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="blockPopups" checked>
                            <span class="slider"></span>
                        </div>
                    </div>
                    <div class="rule-item">
                        <label for="blockSidebar">Sidebar Ads</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="blockSidebar" checked>
                            <span class="slider"></span>
                        </div>
                    </div>
                    <div class="rule-item">
                        <label for="blockVideo">Video Advertisements</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="blockVideo" checked>
                            <span class="slider"></span>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <h3>🔍 Advanced Filters</h3>
                    <div class="rule-item">
                        <label for="blockNative">Native Advertising</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="blockNative">
                            <span class="slider"></span>
                        </div>
                    </div>
                    <div class="rule-item">
                        <label for="blockTrackers">Tracking Scripts</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="blockTrackers" checked>
                            <span class="slider"></span>
                        </div>
                    </div>
                    <div class="rule-item">
                        <label for="blockAnalytics">Analytics</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="blockAnalytics">
                            <span class="slider"></span>
                        </div>
                    </div>
                    <div class="rule-item">
                        <label for="blockSocial">Social Widgets</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="blockSocial">
                            <span class="slider"></span>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <h3>⚡ Testing Options</h3>
                    <div class="rule-item">
                        <label for="showPlaceholders">Show Blocked Placeholders</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="showPlaceholders" checked>
                            <span class="slider"></span>
                        </div>
                    </div>
                    <div class="rule-item">
                        <label for="realTimeMode">Real-time Updates</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="realTimeMode" checked>
                            <span class="slider"></span>
                        </div>
                    </div>
                    <div class="rule-item">
                        <label for="aggressiveMode">Aggressive Blocking</label>
                        <div class="toggle-switch">
                            <input type="checkbox" id="aggressiveMode">
                            <span class="slider"></span>
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="export-btn" onclick="exportRules()">📊 Export Test Results</button>
                <button class="export-btn" onclick="resetToDefaults()">🔄 Reset to Defaults</button>
                <button class="export-btn" onclick="runPerformanceTest()">⚡ Run Performance Test</button>
            </div>
        </div>

        <div class="main-content">
            <div class="test-site" id="testSite">
                <div class="site-header">
                    <h1>📰 Demo News Website</h1>
                    <p>Real-world simulation with various ad patterns</p>
                </div>
                
                <div class="ad-banner" data-ad-type="banner" data-priority="high">
                    🎯 Premium Banner Advertisement - Click for Amazing Deals!
                </div>

                <div class="site-content">
                    <div class="main-article">
                        <h2>Breaking: Revolutionary Web Technologies Transform Digital Landscape</h2>
                        <p>In a groundbreaking development that promises to reshape the digital world, leading technology companies have unveiled a suite of innovative web technologies that enhance user experience while maintaining privacy and security standards.</p>
                        
                        <div class="ad-native" data-ad-type="native" data-priority="medium">
                            📱 Sponsored Content: Discover the Latest Tech Trends - A comprehensive guide to emerging technologies
                        </div>
                        
                        <p>The new standards focus on creating more efficient, accessible, and user-friendly web experiences. Industry experts predict these changes will significantly impact how we interact with digital content.</p>
                        
                        <p>Major browsers are already implementing these features, with full support expected by the end of the year. Early adopters report improved performance and enhanced security measures.</p>
                        
                        <div class="ad-video" data-ad-type="video" data-priority="high">
                            🎬 Video Advertisement
                            <br>▶️ Watch Now - Premium Content
                            <div style="margin-top: 10px; font-size: 0.9rem;">Advertisement • 30 seconds</div>
                        </div>
                        
                        <p>The implementation timeline includes comprehensive testing phases and gradual rollout to ensure compatibility across all platforms and devices.</p>
                    </div>

                    <div class="sidebar">
                        <div class="ad-sidebar" data-ad-type="sidebar" data-priority="medium">
                            💰 Special Offer!<br>
                            Save 50% Today<br>
                            <small>Limited Time Deal</small>
                        </div>
                        
                        <div class="ad-sidebar" data-ad-type="sidebar" data-priority="low">
                            🌟 Trending Now<br>
                            Popular Products<br>
                            <small>Sponsored</small>
                        </div>
                        
                        <div style="background: #f8fafc; padding: 15px; border-radius: 8px; color: #4a5568;">
                            <h4>Related Articles</h4>
                            <ul style="margin-top: 10px; line-height: 1.6;">
                                <li>Web Security Best Practices</li>
                                <li>Future of Digital Marketing</li>
                                <li>Privacy-First Development</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="performance-monitor">
            <h3>📈 Performance Metrics</h3>
            <div class="performance-grid">
                <div class="performance-item">
                    <div class="performance-value" id="loadTime">--</div>
                    <div class="performance-label">Load Time (ms)</div>
                </div>
                <div class="performance-item">
                    <div class="performance-value" id="memoryUsage">--</div>
                    <div class="performance-label">Memory (MB)</div>
                </div>
                <div class="performance-item">
                    <div class="performance-value" id="elementsProcessed">--</div>
                    <div class="performance-label">Elements Processed</div>
                </div>
                <div class="performance-item">
                    <div class="performance-value" id="rulesApplied">--</div>
                    <div class="performance-label">Rules Applied</div>
                </div>
            </div>
        </div>

        <div class="test-results">
            <h3>🔍 Test Results Log</h3>
            <div id="resultsContainer">
                <div class="result-item">
                    <span>System initialized</span>
                    <span class="status-indicator status-allowed">Ready</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        class AdBlockerTestSuite {
            constructor() {
                this.rules = new Map();
                this.elements = [];
                this.stats = {
                    blocked: 0,
                    allowed: 0,
                    total: 0
                };
                this.performance = {
                    startTime: performance.now(),
                    elementsProcessed: 0,
                    rulesApplied: 0
                };
                
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.discoverElements();
                this.createPopupAd();
                this.updateDisplay();
                this.startPerformanceMonitoring();
                this.logResult('Ad Blocker Test Suite initialized', 'allowed');
            }

            setupEventListeners() {
                // Rule toggles
                const controls = [
                    'blockBanners', 'blockPopups', 'blockSidebar', 'blockVideo',
                    'blockNative', 'blockTrackers', 'blockAnalytics', 'blockSocial',
                    'showPlaceholders', 'realTimeMode', 'aggressiveMode'
                ];

                controls.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.addEventListener('change', () => {
                            this.rules.set(id, element.checked);
                            if (document.getElementById('realTimeMode').checked) {
                                this.applyRules();
                            }
                        });
                        this.rules.set(id, element.checked);
                    }
                });

                // Add click handlers for ads
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('ad-banner')) {
                        this.logResult(`Banner ad clicked - ${e.target.textContent.substring(0, 30)}...`, 'allowed');
                    }
                });
            }

            discoverElements() {
                this.elements = [];
                const adElements = document.querySelectorAll('[data-ad-type]');
                
                adElements.forEach((element, index) => {
                    const adInfo = {
                        element: element,
                        type: element.dataset.adType,
                        priority: element.dataset.priority || 'low',
                        id: `ad-${index}`,
                        blocked: false,
                        selector: this.generateSelector(element)
                    };
                    this.elements.push(adInfo);
                });

                this.stats.total = this.elements.length;
                this.performance.elementsProcessed = this.elements.length;
            }

            generateSelector(element) {
                let selector = element.tagName.toLowerCase();
                if (element.className) {
                    selector += '.' + element.className.split(' ').join('.');
                }
                if (element.id) {
                    selector += '#' + element.id;
                }
                if (element.dataset.adType) {
                    selector += `[data-ad-type="${element.dataset.adType}"]`;
                }
                return selector;
            }

            applyRules() {
                this.stats.blocked = 0;
                this.stats.allowed = 0;
                this.performance.rulesApplied = 0;

                this.elements.forEach(adInfo => {
                    const shouldBlock = this.shouldBlockElement(adInfo);
                    this.setElementBlocked(adInfo, shouldBlock);
                    
                    if (shouldBlock) {
                        this.stats.blocked++;
                        this.logResult(`Blocked ${adInfo.type} ad: ${adInfo.selector}`, 'blocked');
                    } else {
                        this.stats.allowed++;
                    }
                    this.performance.rulesApplied++;
                });

                this.updateDisplay();
            }

            shouldBlockElement(adInfo) {
                const rules = this.rules;
                let shouldBlock = false;

                // Basic ad type blocking
                switch (adInfo.type) {
                    case 'banner':
                        shouldBlock = rules.get('blockBanners');
                        break;
                    case 'popup':
                        shouldBlock = rules.get('blockPopups');
                        break;
                    case 'sidebar':
                        shouldBlock = rules.get('blockSidebar');
                        break;
                    case 'video':
                        shouldBlock = rules.get('blockVideo');
                        break;
                    case 'native':
                        shouldBlock = rules.get('blockNative');
                        break;
                }

                // Aggressive mode blocks more elements
                if (rules.get('aggressiveMode')) {
                    if (adInfo.priority === 'low' || adInfo.priority === 'medium') {
                        shouldBlock = true;
                    }
                }

                return shouldBlock;
            }

            setElementBlocked(adInfo, blocked) {
                const element = adInfo.element;
                adInfo.blocked = blocked;

                if (blocked) {
                    element.classList.add('blocked-element');
                    
                    // Show placeholder if enabled
                    if (this.rules.get('showPlaceholders')) {
                        const placeholder = this.createBlockedPlaceholder(adInfo);
                        element.parentNode.insertBefore(placeholder, element.nextSibling);
                    }
                } else {
                    element.classList.remove('blocked-element');
                    this.removeBlockedPlaceholder(element);
                }
            }

            createBlockedPlaceholder(adInfo) {
                const placeholder = document.createElement('div');
                placeholder.className = 'blocked-placeholder';
                placeholder.dataset.placeholderFor = adInfo.id;
                placeholder.innerHTML = `🚫 Blocked ${adInfo.type.toUpperCase()} Ad<br><small>${adInfo.selector}</small>`;
                return placeholder;
            }

            removeBlockedPlaceholder(element) {
                const placeholder = element.parentNode.querySelector(`[data-placeholder-for]`);
                if (placeholder) {
                    placeholder.remove();
                }
            }

            createPopupAd() {
                // Create popup ad after a delay
                setTimeout(() => {
                    if (!this.rules.get('blockPopups')) {
                        const popup = document.createElement('div');
                        popup.className = 'ad-popup';
                        popup.dataset.adType = 'popup';
                        popup.dataset.priority = 'high';
                        popup.innerHTML = `
                            <h4>🎉 Special Offer!</h4>
                            <p>Limited time deal - 70% off premium features!</p>
                            <button class="close-btn" onclick="this.parentElement.remove()">Close</button>
                        `;
                        document.body.appendChild(popup);
                        
                        // Add to elements array
                        this.elements.push({
                            element: popup,
                            type: 'popup',
                            priority: 'high',
                            id: 'popup-ad',
                            blocked: false,
                            selector: '.ad-popup'
                        });
                        
                        this.stats.total++;
                        this.logResult('Dynamic popup ad created', 'allowed');
                        
                        if (this.rules.get('realTimeMode')) {
                            this.applyRules();
                        }
                    }
                }, 3000);

                // Create interstitial ad
                setTimeout(() => {
                    this.createInterstitialAd();
                }, 8000);
            }

            createInterstitialAd() {
                if (!this.rules.get('blockPopups')) {
                    const interstitial = document.createElement('div');
                    interstitial.className = 'ad-interstitial';
                    interstitial.dataset.adType = 'popup';
                    interstitial.dataset.priority = 'high';
                    interstitial.innerHTML = `
                        <div class="interstitial-content">
                            <h2>🚀 Upgrade Your Experience</h2>
                            <p>Join millions of satisfied users with our premium service</p>
                            <button class="close-btn" onclick="this.parentElement.parentElement.remove()">Skip Ad (5s)</button>
                        </div>
                    `;
                    document.body.appendChild(interstitial);
                    
                    this.elements.push({
                        element: interstitial,
                        type: 'popup',
                        priority: 'high',
                        id: 'interstitial-ad',
                        blocked: false,
                        selector: '.ad-interstitial'
                    });
                    
                    this.stats.total++;
                    this.logResult('Interstitial ad displayed', 'allowed');
                    
                    if (this.rules.get('realTimeMode')) {
                        this.applyRules();
                    }
                    
                    // Auto-close after 5 seconds
                    setTimeout(() => {
                        if (interstitial.parentNode) {
                            interstitial.remove();
                        }
                    }, 5000);
                }
            }

            updateDisplay() {
                // Update statistics
                document.getElementById('blockedCount').textContent = this.stats.blocked;
                document.getElementById('allowedCount').textContent = this.stats.allowed;
                document.getElementById('totalCount').textContent = this.stats.total;
                
                const efficiency = this.stats.total > 0 ? 
                    Math.round((this.stats.blocked / this.stats.total) * 100) : 0;
                document.getElementById('efficiencyRate').textContent = efficiency + '%';
                
                // Update efficiency color based on blocking rate
                const efficiencyElement = document.getElementById('efficiencyRate');
                efficiencyElement.className = 'stat-value';
                if (efficiency >= 80) efficiencyElement.classList.add('blocked');
                else if (efficiency >= 50) efficiencyElement.classList.add('total');
                else efficiencyElement.classList.add('allowed');
            }

            startPerformanceMonitoring() {
                setInterval(() => {
                    this.updatePerformanceMetrics();
                }, 1000);
            }

            updatePerformanceMetrics() {
                const loadTime = Math.round(performance.now() - this.performance.startTime);
                document.getElementById('loadTime').textContent = loadTime;
                
                // Simulate memory usage (in a real scenario, this would use performance API)
                const memoryUsage = (Math.random() * 20 + 15).toFixed(1);
                document.getElementById('memoryUsage').textContent = memoryUsage;
                
                document.getElementById('elementsProcessed').textContent = this.performance.elementsProcessed;
                document.getElementById('rulesApplied').textContent = this.performance.rulesApplied;
            }

            logResult(message, status) {
                const container = document.getElementById('resultsContainer');
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';
                
                const timestamp = new Date().toLocaleTimeString();
                resultItem.innerHTML = `
                    <span>${timestamp} - ${message}</span>
                    <span class="status-indicator status-${status}">${status === 'blocked' ? 'Blocked' : 'Allowed'}</span>
                `;
                
                container.appendChild(resultItem);
                
                // Keep only last 10 results
                while (container.children.length > 10) {
                    container.removeChild(container.firstChild);
                }
                
                // Scroll to bottom
                container.scrollTop = container.scrollHeight;
            }

            // Simulate network requests and tracking
            simulateTrackingRequests() {
                if (!this.rules.get('blockTrackers')) {
                    this.logResult('Analytics tracker loaded: google-analytics.com', 'allowed');
                } else {
                    this.logResult('Blocked tracking request to analytics service', 'blocked');
                }
                
                if (!this.rules.get('blockSocial')) {
                    this.logResult('Social widget loaded: facebook.com/plugins', 'allowed');
                } else {
                    this.logResult('Blocked social media widget', 'blocked');
                }
            }
        }

        // Global functions for UI interactions
        function exportRules() {
            const suite = window.adBlockerSuite;
            const exportData = {
                timestamp: new Date().toISOString(),
                rules: Object.fromEntries(suite.rules),
                stats: suite.stats,
                performance: {
                    ...suite.performance,
                    totalTime: performance.now() - suite.performance.startTime
                },
                elements: suite.elements.map(el => ({
                    type: el.type,
                    priority: el.priority,
                    selector: el.selector,
                    blocked: el.blocked
                }))
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], {
                type: 'application/json'
            });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ad-blocker-test-results-${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            suite.logResult('Test results exported successfully', 'allowed');
        }

        function resetToDefaults() {
            const suite = window.adBlockerSuite;
            
            // Reset checkboxes to default values
            const defaults = {
                blockBanners: true,
                blockPopups: true,
                blockSidebar: true,
                blockVideo: true,
                blockNative: false,
                blockTrackers: true,
                blockAnalytics: false,
                blockSocial: false,
                showPlaceholders: true,
                realTimeMode: true,
                aggressiveMode: false
            };
            
            Object.entries(defaults).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) {
                    element.checked = value;
                    suite.rules.set(id, value);
                }
            });
            
            // Remove all placeholders
            document.querySelectorAll('.blocked-placeholder').forEach(el => el.remove());
            
            // Reset elements
            suite.elements.forEach(adInfo => {
                adInfo.element.classList.remove('blocked-element');
                adInfo.blocked = false;
            });
            
            suite.applyRules();
            suite.logResult('Settings reset to default values', 'allowed');
        }

        function runPerformanceTest() {
            const suite = window.adBlockerSuite;
            suite.logResult('Starting performance test...', 'allowed');
            
            const startTime = performance.now();
            
            // Simulate heavy processing
            for (let i = 0; i < 1000; i++) {
                suite.elements.forEach(adInfo => {
                    suite.shouldBlockElement(adInfo);
                });
            }
            
            const endTime = performance.now();
            const duration = Math.round(endTime - startTime);
            
            suite.logResult(`Performance test completed in ${duration}ms`, 'allowed');
            
            // Update performance metrics
            suite.performance.rulesApplied += 1000 * suite.elements.length;
            suite.updatePerformanceMetrics();
            
            // Visual feedback
            const performanceItems = document.querySelectorAll('.performance-item');
            performanceItems.forEach(item => {
                item.classList.add('pulse');
                setTimeout(() => item.classList.remove('pulse'), 2000);
            });
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            window.adBlockerSuite = new AdBlockerTestSuite();
            
            // Start simulation of tracking requests
            setTimeout(() => {
                window.adBlockerSuite.simulateTrackingRequests();
            }, 2000);
            
            // Periodically simulate new ad requests
            setInterval(() => {
                if (Math.random() > 0.7) {
                    window.adBlockerSuite.simulateTrackingRequests();
                }
            }, 10000);
        });

        // Add keyboard shortcuts for power users
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'e':
                        e.preventDefault();
                        exportRules();
                        break;
                    case 'r':
                        e.preventDefault();
                        resetToDefaults();
                        break;
                    case 't':
                        e.preventDefault();
                        runPerformanceTest();
                        break;
                }
            }
        });

        // Advanced features for professional use
        class AdvancedAnalytics {
            constructor() {
                this.heatmapData = [];
                this.userInteractions = [];
                this.blockingPatterns = new Map();
            }

            trackInteraction(element, action) {
                this.userInteractions.push({
                    timestamp: Date.now(),
                    element: element.tagName + (element.className ? '.' + element.className : ''),
                    action: action,
                    blocked: element.classList.contains('blocked-element')
                });
            }

            generateHeatmap() {
                // Simulate heatmap data for blocked vs allowed elements
                const elements = document.querySelectorAll('[data-ad-type]');
                elements.forEach(el => {
                    const rect = el.getBoundingClientRect();
                    this.heatmapData.push({
                        x: rect.left + rect.width / 2,
                        y: rect.top + rect.height / 2,
                        intensity: el.classList.contains('blocked-element') ? 0.1 : 0.9,
                        type: el.dataset.adType
                    });
                });
            }

            getBlockingEffectiveness() {
                const patterns = {};
                this.userInteractions.forEach(interaction => {
                    if (!patterns[interaction.element]) {
                        patterns[interaction.element] = { blocked: 0, allowed: 0 };
                    }
                    if (interaction.blocked) {
                        patterns[interaction.element].blocked++;
                    } else {
                        patterns[interaction.element].allowed++;
                    }
                });
                return patterns;
            }
        }

        // Initialize advanced analytics
        window.analytics = new AdvancedAnalytics();

        // Track clicks for analytics
        document.addEventListener('click', (e) => {
            if (e.target.dataset.adType) {
                window.analytics.trackInteraction(e.target, 'click');
            }
        });
    </script>
</body>
</html>